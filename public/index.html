<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>冒險者公會</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cwtex+Fangsong&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <main id="app-content" class="page"></main>

    <div id="page-templates" style="display: none;">

        <div id="page-home">
            <div class="news-header">
                <div class="news-header-decoration"></div>
                <h1 class="page-main-title">最新情報</h1>
            </div>
            <div id="news-filter-container">
                <p>讀取中...</p>
            </div>
            <div id="news-list-container">
                <p>正在載入最新情報...</p>
            </div>
        </div>

        <div id="page-games">
            <h1 class="page-main-title">桌遊圖鑑</h1>
            <div id="filter-controls">
                <input type="search" id="keyword-search" placeholder="搜尋關鍵字 (遊戲名稱、描述)...">
                <div id="tag-filter-container">
                    <div id="primary-tags" class="filter-group"></div>
                    <div id="secondary-tags" class="filter-group" style="display: none;"></div>
                </div>
                <button id="more-tags-btn">更多標籤</button>
                <button id="clear-filters">清除所有篩選</button>
            </div>
            <div id="game-list-container"><p>正在載入桌遊資料...</p></div>
        </div>
        
        <div id="page-game-details">
            <button class="details-back-button">← 返回列表</button>
            <div class="details-gallery">
                <img src="" alt="" class="details-image-main">
                <div class="details-image-thumbnails"></div>
            </div>
            <h1 class="details-title" style="text-align: center;"></h1>
            <div class="details-section core-info-grid">
                <div class="info-item">
                    <span>👥 建議人數</span>
                    <strong id="game-players">--</strong>
                </div>
                <div class="info-item">
                    <span>⭐ 遊戲難度</span>
                    <strong id="game-difficulty">--</strong>
                </div>
            </div>
            <div class="details-section" id="game-tags-container"></div>
            <div class="details-section">
                <h3>📜 遊戲介紹</h3>
                <p id="game-intro-content"></p>
            </div>
            <div class="details-section" id="game-supplementary-section" style="display: none;">
                <h3>📦 補充說明</h3>
                <p id="game-supplementary-content"></p>
            </div>
            <div class="details-section">
                <h3>💰 價格資訊</h3>
                <div id="game-price-content"></div>
            </div>
        </div>

        <div id="page-news-details">
            <button class="details-back-button">← 返回列表</button>
            <div class="details-header">
                <h1 class="details-title" id="news-details-title"></h1>
                <p class="news-details-meta">
                    <span id="news-details-category"></span> | <span id="news-details-date"></span>
                </p>
                <img src="" alt="" class="details-image" id="news-details-image" style="display: none;">
            </div>
            <div class="details-section">
                <h3>詳細內容</h3>
                <div id="news-details-content"></div>
            </div>
        </div>            

        <div id="page-profile">
            <h1 class="page-main-title">冒險者資料</h1>
            <div id="qrcode-container">
                <div id="qrcode"></div>
            </div>
            <div class="profile-details-grid">
                <div class="profile-avatar">
                    <img id="profile-picture" src="placeholder.jpg" alt="Profile Picture">
                </div>
                <div class="profile-stats">
                    <h2 id="display-name">讀取中...</h2>
                    <p><strong>職業：</strong><span id="user-class">--</span></p>
                    <p><strong>等級：</strong><span id="user-level">--</span></p>
                    <p><strong>經驗值：</strong><span id="user-exp">-- / --</span></p>
                    <p id="user-perk-line" style="display: none;"><strong>職業福利：</strong><span id="user-perk"></span></p>
                </div>
            </div>
            <div class="profile-actions">
               <button class="cta-button" id="edit-profile-btn">冒險者<br>檔案</button>
               <button class="cta-button" id="my-bookings-btn">預約的<br>冒險旅程</button>
               <button class="cta-button" id="my-exp-history-btn">經驗<br>成長紀錄</button>
               <button class="cta-button" id="rental-history-btn">桌遊<br>租借紀錄</button>
            </div>
        </div>

        <div id="page-my-bookings">
            <button class="details-back-button">← 返回個人資料</button>
            <h1 style="text-align: center;">我預約的冒險旅程</h1>
            <div id="my-bookings-container"><p>正在查詢您的預約紀錄...</p></div>
            <button class="cta-button" id="toggle-past-bookings-btn" style="margin-top: 20px; background: var(--color-text-secondary);">查看過往紀錄</button>
            <div id="past-bookings-container" style="display: none; margin-top: 20px;">
                <h2 style="text-align: center; font-size: 1.5rem;">過往的旅程</h2>
            </div>
        </div>

        <div id="page-my-exp-history">
            <button class="details-back-button">← 返回個人資料</button>
            <h1 style="text-align: center;">經驗成長紀錄</h1>
            <div id="my-exp-history-container"><p>正在查詢您的經驗紀錄...</p></div>
        </div>

        <div id="page-rental-history">
            <button class="details-back-button">← 返回個人資料</button>
            <h1 style="text-align: center;">桌遊租借紀錄</h1>
            <div id="rental-history-container"><p>正在查詢您的租借紀錄...</p></div>
            <button class="cta-button" id="toggle-past-rentals-btn" style="margin-top: 20px; background: var(--color-text-secondary);">查看過往紀錄</button>
            <div id="past-rentals-container" style="display: none; margin-top: 20px;">
                <h2 style="text-align: center; font-size: 1.5rem;">過往的租借</h2>
            </div>
        </div>

        <div id="page-edit-profile">
            <button class="details-back-button" style="margin-bottom: 20px;">← 返回</button>
            <div style="text-align: center;">
                <h1>冒險者檔案</h1>
                <p style="color: #666; margin-top: -10px; margin-bottom: 30px;">冒險者履歷，讓我們更了解你！</p>
            </div>
             <form id="edit-profile-form">
                <div class="input-group">
                    <label for="edit-profile-name">(LINE)</label>
                    <input type="text" id="edit-profile-name" readonly style="background-color: #e9ecef; cursor: not-allowed;">
                </div>
                <div class="input-group">
                    <label for="edit-profile-real-name">姓名</label>
                    <input type="text" id="edit-profile-real-name" placeholder="請填寫真實姓名，以便訂位與租借核對">
                </div>
                <div class="input-group">
                    <label for="edit-profile-nickname">綽號</label>
                    <input type="text" id="edit-profile-nickname" placeholder="您希望我們怎麼稱呼您？">
                </div>
                <div class="input-group">
                    <label for="edit-profile-phone">聯絡電話</label>
                    <input type="tel" id="edit-profile-phone" maxlength="10" placeholder="用於訂位等聯絡事宜">
                </div>
                <div class="input-group">
                    <label for="edit-profile-email">電子信箱</label>
                    <input type="email" id="edit-profile-email" placeholder="用於接收活動通知 (選填)">
                </div>
                <div class="input-group">
                    <label>偏好的遊戲類型 (可多選)</label>
                    <div id="preferred-games-container" class="tag-selection-container"></div>
                    <div id="preferred-games-other-container" class="input-group" style="display: none; margin-top: 15px;">
                        <label for="preferred-games-other-input">其他類型 (請以逗號分隔)</label>
                        <input type="text" id="preferred-games-other-input" placeholder="例如：合作, 奇幻">
                    </div>
                </div>
                <button type="submit" class="cta-button" style="margin-top: 20px;">儲存資料</button>
            </form>
            <p id="edit-profile-form-status" class="form-status"></p>
        </div>

        <div id="page-booking">
            <div id="booking-wizard-container">
                <div id="step-preference" class="booking-step active">
                    <div class="booking-header"><h1 class="page-main-title">場地預約</h1><p class="booking-subtitle">冒險從你預約的這天開始</p></div>
                    <div class="preference-options">
                        <button class="preference-btn" data-preference="一次性"><h3>🎟️ 一次性入場</h3><p><strong>平日 $150 / 假日 $250</strong><br>適合長時間暢玩</p></button>
                    </div>
                    <button class="cta-button" id="view-my-bookings-btn" style="margin-top: 20px; background: var(--color-text-secondary);">查看我的預約</button>
                    <div class="discount-highlight"><p>✨ <strong>提前三日預約，享每人現折 $20 優惠！</strong></p></div>
                    <div class="booking-notice"><p><strong>請注意：</strong>包廂及當日預約請透過 LINE 官方帳號或電話聯繫我們。</p></div>
                </div>
                <div id="step-date-and-slots" class="booking-step">
                    <button class="back-button">← 返回</button>
                    <h2>選擇預約日期與時段</h2>
                    <div class="calendar-and-slots-container">
                        <div id="booking-datepicker-container"></div>
                        <div id="booking-slots-wrapper">
                             <p id="slots-placeholder">請先從上方選擇日期</p>
                             <div id="booking-slots-container"></div>
                        </div>
                    </div>
                </div>
                <div id="step-contact" class="booking-step">
                    <button class="back-button">← 返回</button>
                    <h2>填寫預約資訊</h2>
                    <div class="input-group"><label>您選擇的場次：</label><div id="contact-summary"></div></div>
                    <div class="input-group"><label for="booking-people">預約總人數：</label><input type="number" id="booking-people" min="1" max="20" placeholder="請輸入總人數"></div>
                    <div class="input-group"><label for="contact-name">預約姓名：</label><input type="text" id="contact-name" placeholder="請輸入您的姓名"></div>
                    <div class="input-group"><label for="contact-phone">聯絡電話：</label><input type="tel" id="contact-phone" placeholder="請輸入您的手機號碼" maxlength="10"></div>
                    <button id="to-summary-btn" class="cta-button">下一步：確認資訊</button>
                </div>
                <div id="step-summary" class="booking-step">
                    <button class="back-button">← 返回</button>
                    <h2>確認預約內容</h2>
                    <div id="booking-summary-card" class="summary-card"></div>
                    <button id="confirm-booking-btn" class="cta-button">確認送出</button>
                </div>
                <div id="step-result" class="booking-step">
                    <div id="booking-result-content"></div>
                </div>
            </div>
        </div>
        
        <div id="page-info">
            <h1 class="page-main-title">店家資訊</h1>
            <div id="store-info-container">
                <div class="info-section">
                    <h2>冒險者公會</h2>
                    <p><strong>地址：</strong><span id="store-address">讀取中...</span></p>
                    <p><strong>電話：</strong><span id="store-phone">讀取中...</span></p>
                </div>
                <div class="info-section">
                    <h2>營業時間</h2>
                    <p><pre id="store-hours">讀取中...</pre></p>
                </div>
                <div class="info-section">
                    <h2>公會介紹</h2>
                    <p id="store-description">讀取中...</p>
                </div>
            </div>
        </div>

    </div>

    <nav id="tab-bar">
        <button class="tab-button active" data-target="page-home">最新<br>情報</button>
        <button class="tab-button" data-target="page-games">桌遊<br>圖鑑</button>
        <button class="tab-button" data-target="page-profile">冒險者<br>資料</button>
        <button class="tab-button" data-target="page-booking">場地<br>預約</button>
        <button class="tab-button" data-target="page-info">店家<br>資訊</button>
    </nav>

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/zh-tw.js"></script>
    <script src="/config.js"></script>
    <script src="/script.js"></script>
</body>
</html>